(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{111:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(24),l=a.n(s),c=a(2),i=a(6),o=a(7),d=a(9),u=a(8),m=a(1),p=a.n(m),v=a(3),h=a(55),g=a.n(h).a.create({baseURL:"https://collaps.xyz/collapsapi/api"}),f={insertUser:function(e){return g.post("/user",e)},updateUserById:function(e,t){return g.put("/user/".concat(e),t)},deleteUserById:function(e){return g.delete("/user/".concat(e))},getAllUsers:function(){return g.get("/users")},getUserById:function(e){return g.get("/user/id/".concat(e))},getUserByPseudo:function(e){return g.get("/user/pseudo/".concat(e))},insertChannel:function(e){return g.post("/channel",e)},updateChannelById:function(e,t){return g.put("/channel/".concat(e),t)},deleteChannelById:function(e){return g.delete("/channel/".concat(e))},getChannelById:function(e){return g.get("/channel/id/".concat(e))},insertFile_avatar:function(e){return g.post("/file_avatar",e)},getFileById_avatar:function(e){return g.get("/file_avatar/id/".concat(e))},deleteFileById_avatar:function(e){return g.delete("/file_avatar/id/".concat(e))}},E=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).handleChangeInputPseudo=function(){var e=Object(v.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.target.value,n.setState({pseudo:{value:a,warning:""}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleChangeInputPassword=function(){var e=Object(v.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.target.value,n.setState({password:{value:a,warning:""}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleLoginUser=function(){var e=Object(v.a)(p.a.mark((function e(t){var a,r,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=n.state,r=a.pseudo,s=a.password,0===r.value.length||0===s.value.length){e.next=5;break}return e.next=5,f.getUserByPseudo(r.value).then((function(e){null===e.data.data?n.setState({pseudo:{value:r.value,warning:"pseudo inconnu"}}):e.data.data.password!==s.value?n.setState({password:{value:s.value,warning:"mot de passe invalide"}}):(console.log("Bienvenue ".concat(e.data.data.pseudo)),n.props.onIdSubmit(e.data.data.id))}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.state={pseudo:{value:"",warning:""},password:{value:"",warning:""}},n}return Object(o.a)(a,[{key:"render",value:function(){var e=this.state,t=e.pseudo,a=e.password;return r.a.createElement("div",{className:"connection"},r.a.createElement("form",{className:"connection-form",onSubmit:this.handleLoginUser},r.a.createElement("div",{className:"connectionToolHeader"},r.a.createElement("div",{className:"connectionToolHeader-title"},"FInt.Tchat"),r.a.createElement("div",{className:"connectionToolHeader-subtitle"},"Bienvenue dans l'espace de connexion")),r.a.createElement("div",{className:"connection-body scroller"},r.a.createElement("div",{className:"connection-body-input"},r.a.createElement("div",{className:"title"},"Pseudo ",t.warning?r.a.createElement("span",{className:"title-warning"},"- ",t.warning):null),r.a.createElement("input",{className:"input ".concat(t.warning?"input-warning":""),type:"text",autoFocus:!0,value:t.value,onChange:this.handleChangeInputPseudo}),r.a.createElement("div",{className:"spacer"}),r.a.createElement("div",{className:"title"},"Mot de passe ",a.warning?r.a.createElement("span",{className:"title-warning"},"- ",a.warning):null),r.a.createElement("input",{className:"input ".concat(a.warning?"input-warning":""),type:"password",value:a.value,onChange:this.handleChangeInputPassword}),r.a.createElement("div",{className:"link"},r.a.createElement("a",{href:"https://google.com"},"Tu as oubli\xe9 ton mot de passe ?")))),r.a.createElement("div",{className:"connectionToolFooter"},r.a.createElement("div",{className:"connectionToolFooter-btn"},r.a.createElement("button",{className:"btn-text-default",type:"submit"},r.a.createElement("div",{className:"content"},"Se connecter")),r.a.createElement("button",{className:"btn-text-simple",type:"button",onClick:this.props.hide},r.a.createElement("div",{className:"content"},"S'inscrire"))))))}}]),a}(n.Component),w=a(40),b=w.validityPseudo,y=w.validityPassword,N=w.validityPasswordConfirm,C=w.validityPasswordConfirmForPassword,x=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).handleChangeInputPseudo=function(){var e=Object(v.a)(p.a.mark((function e(t){var a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.target.value,r=b(a),n.setState({pseudo:{value:a,warning:r.warning,valid:r.valid}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleChangeInputPassword=function(){var e=Object(v.a)(p.a.mark((function e(t){var a,r,s,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.target.value,r=y(a),n.setState({password:{value:a,warning:r.warning,valid:r.valid}}),s=n.state.passwordConfirm,l=C(s,a),n.setState({passwordConfirm:{value:s.value,warning:l.warning,valid:l.valid}});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleChangeInputPasswordConfirm=function(){var e=Object(v.a)(p.a.mark((function e(t){var a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.target.value,r=N(a,n.state.password.value),n.setState({passwordConfirm:{value:a,warning:r.warning,valid:r.valid}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleCreateUser=Object(v.a)(p.a.mark((function e(){var t,a,r,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state,a=t.pseudo,r=t.password,s=t.passwordConfirm,!0!==a.valid||!0!==r.valid||!0!==s.valid){e.next=4;break}return e.next=4,f.getUserByPseudo(a.value).then((function(e){if(null!==e.data.data)n.setState({pseudo:{value:a.value,warning:"ce pseudo est d\xe9j\xe0 utilis\xe9"}});else{var t=(Math.floor(1e16*Math.random())+1e17).toString(),s={id:t,pseudo:a.value,password:r.value,activity:"online",channels:[]};f.insertUser(s).then((function(e){n.props.onIdSubmit(t)}),(function(e){console.log("Probl\xe8me d'enregistrement dans la base de donn\xe9es"),console.log(e)}))}}));case 4:case"end":return e.stop()}}),e)}))),n.state={pseudo:{value:"",warning:"",valid:!1},password:{value:"",warning:"",valid:!1},passwordConfirm:{value:"",warning:"",valid:!1}},n}return Object(o.a)(a,[{key:"render",value:function(){var e=this.state,t=e.pseudo,a=e.password,n=e.passwordConfirm;return r.a.createElement("div",{className:"connection"},r.a.createElement("form",{className:"connection-form"},r.a.createElement("div",{className:"connectionToolHeader"},r.a.createElement("div",{className:"connectionToolHeader-title"},"FInt.Tchat"),r.a.createElement("div",{className:"connectionToolHeader-subtitle"},"Bienvenue dans l'espace d'inscription")),r.a.createElement("div",{className:"connection-body scroller"},r.a.createElement("div",{className:"connection-body-input"},r.a.createElement("div",{className:"title"},"Pseudo ",t.warning?r.a.createElement("span",{className:"title-warning"},"- ",t.warning):null),r.a.createElement("input",{className:"input ".concat(t.warning?"input-warning":""),type:"text",autoFocus:!0,required:!0,value:t.value,onChange:this.handleChangeInputPseudo}),r.a.createElement("div",{className:"spacer"}),r.a.createElement("div",{className:"title"},"Mot de passe ",a.warning?r.a.createElement("span",{className:"title-warning"},"- ",a.warning):null),r.a.createElement("input",{className:"input ".concat(a.warning?"input-warning":""),type:"password",required:!0,value:a.value,onChange:this.handleChangeInputPassword}),r.a.createElement("div",{className:"spacer"}),r.a.createElement("div",{className:"title"},"Confirmer le mot de passe ",n.warning?r.a.createElement("span",{className:"title-warning"},"- ",n.warning):null),r.a.createElement("input",{className:"input ".concat(n.warning?"input-warning":""),type:"password",required:!0,value:n.value,onChange:this.handleChangeInputPasswordConfirm}))),r.a.createElement("div",{className:"connectionToolFooter"},r.a.createElement("div",{className:"connectionToolFooter-btn"},r.a.createElement("button",{className:"btn-text-default",type:"button",onClick:this.handleCreateUser},r.a.createElement("div",{className:"content"},"S'inscrire")),r.a.createElement("button",{className:"btn-text-simple",type:"button",onClick:this.props.hide},r.a.createElement("div",{className:"content"},"Se connecter"))))))}}]),a}(n.Component),S=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).toggle=function(){n.setState((function(e){return{isShowing:!e.isShowing}}))},n.state={isShowing:!0},n}return Object(o.a)(a,[{key:"render",value:function(){return this.state.isShowing?r.a.createElement(E,{onIdSubmit:this.props.onIdSubmit,hide:this.toggle}):r.a.createElement(x,{onIdSubmit:this.props.onIdSubmit,hide:this.toggle})}}]),a}(n.Component);var j=r.a.createContext();function O(){return Object(n.useContext)(j)}function I(e){var t=e.id,a=e.children,s=Object(n.useState)(null),l=Object(c.a)(s,2),i=l[0],o=l[1];Object(n.useEffect)((function(){null===i&&f.getUserById(t).then((function(e){return o(e.data.data)}))}),[t,i]);var d={client:i,setClient:o,updateUser:function(e,t){var a=t;f.updateUserById(e,a)}};return r.a.createElement(j.Provider,{value:d},a)}var B=j,k=a(4),P=a(56),U=a.n(P),H=r.a.createContext();function F(e){var t=e.id,a=e.children,s=Object(n.useState)(),l=Object(c.a)(s,2),i=l[0],o=l[1];return Object(n.useEffect)((function(){var e=U()("https://collaps.xyz",{path:"/collapssocket",query:{id:t}});return o(e),function(){return e.close()}}),[t]),r.a.createElement(H.Provider,{value:i},a)}var T=r.a.createContext();function M(){return Object(n.useContext)(T)}function z(e){e.id;var t=e.children,a=Object(n.useContext)(H),s=Object(n.useState)(null),l=Object(c.a)(s,2),i=l[0],o=l[1],d=Object(n.useRef)(i);Object(n.useEffect)((function(){d.current=i}));var u=Object(n.useState)([]),m=Object(c.a)(u,2),p=m[0],v=m[1],h=Object(n.useRef)(p);Object(n.useEffect)((function(){h.current=p}));var g=Object(n.useState)(null),E=Object(c.a)(g,2),w=E[0],b=E[1];Object(n.useEffect)((function(){if(null!=a){var e=function(e){console.log(e);var t=h.current.findIndex((function(t){return t.id===e.channelId}));if(-1!==t){var a=Object(k.a)(h.current);a[t].messages=[].concat(Object(k.a)(a[t].messages),[{sender:e.sender,date:e.date,text:e.text}]),v(a)}else v((function(t){return[].concat(Object(k.a)(t),[{id:e.channelId,messages:[{sender:e.sender,date:e.date,text:e.text}]}])}))};return a.on("receive-message",e),function(){return a.off("receive-message",e)}}}),[a]);var y={channels:i,setChannels:o,messagesChannels:p,setMessagesChannels:v,selectedChannel:w,setSelectedChannel:b,createChannel:function(e){f.insertChannel(e).then((function(e){}))},sendMessage:function(e,t,n){var r,s=new Date;!function(e){var t=h.current.findIndex((function(t){return t.id===e.channelId}));if(-1!==t){var a=Object(k.a)(h.current);a[t].messages=[].concat(Object(k.a)(a[t].messages),[{sender:e.sender,date:e.date,text:e.text}]),console.log(a),v(a)}else v((function(t){return[].concat(Object(k.a)(t),[{id:e.channelId,messages:[{sender:e.sender,date:e.date,text:e.text}]}])}))}({channelId:e.id,sender:{id:n.id,pseudo:n.pseudo},date:s,text:t}),a.emit("send-message",{recipients:e.recipients,channelId:e.id,sender:{id:n.id,pseudo:n.pseudo},date:s,text:t}),r={channel:e,sender:{id:n.id,pseudo:n.pseudo},date:s,text:t},f.getChannelById(r.channel.id).then((function(e){(e=e.data.data).messages.push({sender:r.sender.id,date:r.date,text:r.text}),f.updateChannelById(e.id,{data:{messages:e.messages}}).then((function(e){}))}),(function(e){console.log(e)}))}};return r.a.createElement(T.Provider,{value:y},t)}function A(){var e=O().client,t=M(),a=t.channels,s=t.setChannels,l=t.selectedChannel,c=t.setSelectedChannel,i=t.setMessagesChannels;function o(e){return new Promise((function(t){var a=e.channels;a.filter((function(e){return"private"===e.type})).forEach((function(n,r){f.getChannelById(n.id).then((function(n){var s=n.data.data.recipients.filter((function(t){return t!==e.id}))[0];f.getUserById(s).then((function(s){if(null===s.data.data)for(var l=0;l<e.channels.length;l++)e.channels[l].id===n.data.data.id&&(e.channels.splice(l,1),f.updateUserById(e.id,{data:{channels:e.channels}}).then((function(e){})),f.deleteChannelById(n.data.data.id));var c=n.data.data;if(c.recipients=[{id:s.data.data.id,pseudo:s.data.data.pseudo}],Object.assign(c,{selected:!1}),Object.assign(c,{key:r}),a[r]=c,e.channels.length===r+1)return t(a)}))}))}))}))}return Object(n.useEffect)((function(){if(null!==e){if(0===e.channels.length)return s([]);!function(){t.apply(this,arguments)}()}function t(){return(t=Object(v.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",o(e).then((function(e){return s(e)})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}}),[s,e]),null===a?r.a.createElement("div",{className:"sidebar-body-info"},"Chargement..."):0===a.length?r.a.createElement("div",{className:"sidebar-body-info"},"Aucun contact"):r.a.createElement(r.a.Fragment,null,a.map((function(e){return r.a.createElement("button",{key:e.id,className:"sidebar-body-contact ".concat(null===l?null:l.id===e.id?"selected":""),onClick:function(){i([]),c(e)}},r.a.createElement("div",{className:"sidebar-body-contact-content"},r.a.createElement("div",{className:"sidebar-body-contact-content-avatar"},r.a.createElement("svg",{width:"40",height:"32",viewBox:"0 0 40 32","aria-hidden":"true"},r.a.createElement("foreignObject",{x:"0",y:"0",width:"32",height:"32"},r.a.createElement("img",{className:"avatar",src:"https://collaps.xyz/collapsapi/api/file_avatar/id/"+e.recipients[0].id,"aria-hidden":"true",alt:""})),r.a.createElement("rect",{className:"online",fill:"currentColor",width:"10",height:"10",x:"22",y:"22",rx:"15",ry:"15"}))),r.a.createElement("div",{className:"sidebar-body-contact-content-text"},r.a.createElement("div",{className:"username"},r.a.createElement("div",{className:"overflow"},e.recipients[0].pseudo)))))})))}function _(){M().setSelectedChannel,O().client;return r.a.createElement("div",{className:"sidebar-body-info"},"Aucun groupe")}var G=function(e){var t=e.isShowing,a=e.hide,s=O(),l=s.client,i=s.updateUser,o=M(),d=o.channels,u=o.createChannel,m=o.setChannels,p=o.setSelectedChannel,v=Object(n.useState)({value:"",warning:""}),h=Object(c.a)(v,2),g=h[0],E=h[1];return t?r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{className:"createChannelPrivate",onSubmit:function(e){if(e.preventDefault(),0===g.value.length)return E({value:"",warning:"Il faut entr\xe9 un id"});if(18!==g.value.length&&!/^[0-9]*$/.test(g.value))return E({value:"",warning:"Ceci n'est pas un id valide"});if(g.value===l.id)return E({value:"",warning:"Tu ne peux pas t'ajouter"});var t=!0;if(l.channels.filter((function(e){return"private"===e.type})).forEach((function(e){console.log(e),e.id===g.value&&(t=!1)})),!1===t)return E({value:"",warning:"Ce contact existe d\xe9j\xe0"});f.getUserById(g.value).then((function(e){e=e.data.data;var t=(Math.floor(1e16*Math.random())+1e17).toString();m((function(a){return[].concat(Object(k.a)(a),[{id:t,type:"private",recipients:[{id:e.id,pseudo:e.pseudo}],messages:[]}])})),p({id:t,type:"private",recipients:[{id:e.id,pseudo:e.pseudo}],messages:[],selected:!0,key:0===d.length?0:d.length-1});var n=l.channels;n.push({id:t,type:"private"});var r=e.channels;r.push({id:t,type:"private"}),i(l.id,{data:{channels:n}}),i(e.id,{data:{channels:r}}),u({id:t,type:"private",recipients:[l.id,e.id],messages:[]}),E({value:"",warning:""}),a()}),(function(e){console.log(e)}))}},r.a.createElement("div",{className:"createChannelPrivate-header"},r.a.createElement("div",{className:"title"},"Ajouter un contact")),r.a.createElement("div",{className:"createChannelPrivate-body"},g.warning?r.a.createElement("div",{className:"title-warning"},g.warning," "):null,r.a.createElement("input",{className:"input",type:"text",placeholder:"Id",value:g.value,onChange:function(e){return E({value:e.target.value,warning:""})}})),r.a.createElement("div",{className:"createChannelPrivate-footer"},r.a.createElement("button",{className:"btn-text-small",type:"submit"},"Ajouter")))):null};var L=function(e){var t=e.isShowing,a=e.hide,s=O().client,l=Object(n.useState)([]),i=Object(c.a)(l,2),o=i[0],d=i[1],u=M().createChannel;return t?r.a.createElement("form",{className:"createChannelPrivate",onSubmit:function(e){e.preventDefault(),u(o),d([]),a()}},r.a.createElement("div",{className:"createChannelPrivate-header"},r.a.createElement("div",{className:"title"},"Cr\xe9e une conversation")),r.a.createElement("div",{className:"createChannelPrivate-body"},null==s?null:s.channels.filter((function(e){return e.recipients.length<2})).map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement("input",{type:"checkbox",id:e.id,value:o.includes(e.recipients[0].id),onChange:function(){return t=e.recipients[0].id,void d((function(e){return e.includes(t)?e.filter((function(e){return t!==e})):[].concat(Object(k.a)(e),[t])}));var t}}),r.a.createElement("label",null,e.recipients.map((function(e){return e.pseudo})).join(", ")))}))),r.a.createElement("div",{className:"createChannelPrivate-footer"},r.a.createElement("button",{className:"btn-text-small",type:"submit"},"Ajouter"))):null},V=a(18),D=a(40).validityPseudo,q=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).handleChangeInputAvatar=function(){var e=Object(v.a)(p.a.mark((function e(t){var a,r,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target.files,r=a[0],s=/image.*/,r.type.match(s)){e.next=5;break}return e.abrupt("return");case 5:n.setState({selectedFiles:t.target.files});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleChangeInputPseudo=function(){var e=Object(v.a)(p.a.mark((function e(t){var a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.target.value,r=D(a),n.setState({pseudo:{value:a,warning:r.warning,valid:r.valid}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.state={selectedFiles:[],pseudo:{value:"x",warning:"",valid:!1}},n.handleUpdateUser=n.handleUpdateUser.bind(Object(V.a)(n)),n.resetAndHide=n.resetAndHide.bind(Object(V.a)(n)),n}return Object(o.a)(a,[{key:"handleUpdateUser",value:function(){var e=this;if(0!==this.state.selectedFiles.length){var t=new FormData,a=this.state.selectedFiles[0].name;t.append("file",this.state.selectedFiles[0],"".concat(this.props.client.id,".").concat(a.substring(a.lastIndexOf(".")+1,a.length))),f.deleteFileById_avatar(this.props.client.id).then((function(e){!0===e.data.success&&f.insertFile_avatar(t).then((function(e){console.log("Upload Success")})).catch((function(e){console.log("Upload Error")}))}))}var n=this.state.pseudo;!0===n.valid?f.getUserByPseudo(n.value).then((function(t){null!==t.data.data?e.setState({pseudo:{value:n.value,warning:"ce pseudo est d\xe9j\xe0 utilis\xe9"}}):(e.resetAndHide(),f.updateUserById(e.props.client.id,{data:{pseudo:n.value}}).then((function(e){console.log("Mise \xe0 jour de l'utilisateur")}),(function(e){console.log("Probl\xe8me d'enregistrement dans la base de donn\xe9es"),console.log(e)})))})):0===n.value.length?this.setState({pseudo:{value:n.value,warning:"Ne peut \xeatre vide"}}):this.resetAndHide()}},{key:"resetAndHide",value:function(){this.setState({selectedFiles:[],pseudo:{value:"x",warning:"",valid:!1}}),this.props.hide()}},{key:"render",value:function(){var e=this.state,t=e.pseudo,a=e.selectedFiles,n=this.props.client;return this.props.isShowing?l.a.createPortal(r.a.createElement("div",{className:"window"},r.a.createElement("div",{className:"window-backdrop",onClick:this.props.hide}),r.a.createElement("form",{className:"window-container"},r.a.createElement("div",{className:"windowToolHeader"},r.a.createElement("div",{className:"windowToolHeader-title"},"Param\xe8tres"),r.a.createElement("div",{className:"windowToolHeader-subtitle"},"Clic sur ton pseudo pour le modifier")),r.a.createElement("div",{className:"clientSetting-body scroller"},r.a.createElement("div",{className:"clientSetting-body-divider"},r.a.createElement("div",{className:"title"},"Compte"),r.a.createElement("div",{className:"bar"})),r.a.createElement("div",{className:"clientSetting-body-account"},r.a.createElement("div",{className:"clientSetting-body-account-avatar"},r.a.createElement("img",{className:"avatar",src:0===a.length?null===n?null:"https://collaps.xyz/collapsapi/api/file_avatar/id/".concat(n.id):URL.createObjectURL(a[0]),alt:"user account"}),r.a.createElement("input",{className:"avatarUploaderInput",type:"file",accept:".jpg,.jpeg,.png,.gif",onChange:this.handleChangeInputAvatar}),r.a.createElement("div",{className:"avatarUploaderIcon"})),r.a.createElement("div",{className:"clientSetting-body-account-info"},r.a.createElement("div",{className:"pseudo"},r.a.createElement("div",{className:"title"},"Pseudo ",t.warning?r.a.createElement("span",{className:"title-warning"},"- ",t.warning):null),r.a.createElement("div",{className:"content"},r.a.createElement("input",{className:"input",type:"text",maxLength:"32",required:!0,value:"x"===t.value?null===n?null:n.pseudo:t.value,onChange:this.handleChangeInputPseudo}))),r.a.createElement("div",{className:"id"},r.a.createElement("div",{className:"title"},"Id"),r.a.createElement("div",{className:"content"},n.id)))),r.a.createElement("div",{className:"clientSetting-body-divider"},r.a.createElement("div",{className:"title"},"Informations"),r.a.createElement("div",{className:"bar"})),r.a.createElement("div",{className:"clientSetting-body-info"},r.a.createElement("div",{className:"clientSetting-body-info-compatibility"},r.a.createElement("div",{className:"title"},"Compatible"),r.a.createElement("div",{className:"navigator"},r.a.createElement("li",null,"Mozilla Firefox"),r.a.createElement("li",null,"Google Chrome"),r.a.createElement("li",null,"Apple Safari"),r.a.createElement("li",null,"Microsoft Edge"))),r.a.createElement("div",{className:"clientSetting-body-info-support"},r.a.createElement("div",{className:"title"},"Support"),r.a.createElement("div",{className:"navigator"},r.a.createElement("li",null,"Windows"),r.a.createElement("li",null,"MacOS"),r.a.createElement("li",null,"Android"),r.a.createElement("li",null,"iOS"))))),r.a.createElement("div",{className:"windowToolFooter"},r.a.createElement("button",{className:"btn-icon-default-red",type:"button"},r.a.createElement("svg",{viewBox:"0 0 384 384","aria-hidden":"false",width:"21",height:"21",x:"0",y:"0"},r.a.createElement("path",{fill:"currentColor",d:"M341.333,0H42.667C19.093,0,0,19.093,0,42.667V128h42.667V42.667h298.667v298.667H42.667V256H0v85.333\r C0,364.907,19.093,384,42.667,384h298.667C364.907,384,384,364.907,384,341.333V42.667C384,19.093,364.907,0,341.333,0z"}),r.a.createElement("polygon",{fill:"currentColor",points:"151.147,268.48 181.333,298.667 288,192 181.333,85.333 151.147,115.52 206.293,170.667 0,170.667 0,213.333 \r 206.293,213.333"}))),r.a.createElement("div",{className:"windowToolFooter-btn"},r.a.createElement("button",{className:"btn-text-default",type:"button",onClick:this.handleUpdateUser},r.a.createElement("div",{className:"content"},"Termin\xe9")),r.a.createElement("button",{className:"btn-text-simple",type:"button",onClick:this.resetAndHide},r.a.createElement("div",{className:"content"},"Annuler")))))),document.body):null}}]),a}(n.Component),R=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).toggleNewContact=function(){n.state.isShowingNewContact?n.setState({isShowingNewContact:!1}):n.setState({isShowingNewContact:!0})},n.toggleNewGroupe=function(){n.state.isShowingNewGroupe?n.setState({isShowingNewGroupe:!1}):n.setState({isShowingNewGroupe:!0})},n.toggleSetting=function(){n.state.isShowingSetting?n.setState({isShowingSetting:!1}):n.setState({isShowingSetting:!0})},n.copyId=function(){var e=n.context.client;navigator.clipboard.writeText(null==e?null:e.id).then((function(){console.log("Id copier")}),(function(e){console.log("Nous n'avons pas pu copier votre id"),console.log(e)}))},n.searchSystem=function(){var e,t,a,n;for(e=document.getElementById("myInput").value.toUpperCase(),t=document.getElementById("channelsPrivates").getElementsByTagName("button"),n=0;n<t.length;n++)((a=t[n].getElementsByClassName("overflow")[0]).textContent||a.innerText).toUpperCase().indexOf(e)>-1?t[n].style.display="":t[n].style.display="none"},n.state={isShowingNewContact:!1,isShowingNewGroupe:!1,isShowingSetting:!1},n}return Object(o.a)(a,[{key:"render",value:function(){var e=this.context.client;return r.a.createElement("div",{className:"sidebar"},r.a.createElement("div",{className:"sidebar-header"},r.a.createElement("input",{className:"sidebar-header-search",type:"text",id:"myInput",onKeyUp:this.searchSystem,placeholder:"Rechercher une conversation"})),r.a.createElement("div",{className:"sidebar-body scroller"},r.a.createElement("div",{className:"title"},r.a.createElement("span",{className:"text"},"Contacts"),r.a.createElement("button",{className:"button",type:"button","aria-label":"Cr\xe9er un contact",onClick:this.toggleNewContact},r.a.createElement("svg",{x:"0",y:"0","aria-hidden":"false",width:"24",height:"24",viewBox:"0 0 18 18"},r.a.createElement("polygon",{fillRule:"nonzero",fill:"currentColor",points:"15 10 10 10 10 15 8 15 8 10 3 10 3 8 8 8 8 3 10 3 10 8 15 8"})))),r.a.createElement("div",{id:"channelsPrivates","aria-label":"Salons priv\xe9s"},r.a.createElement(G,{isShowing:this.state.isShowingNewContact,hide:this.toggleNewContact}),r.a.createElement(A,null)),r.a.createElement("div",{className:"title",id:"channelsGroupesTitle"},r.a.createElement("span",{className:"text"},"Groupes"),r.a.createElement("button",{className:"button",type:"button","aria-label":"Cr\xe9er un groupe",onClick:this.toggleNewGroupe},r.a.createElement("svg",{x:"0",y:"0","aria-hidden":"false",width:"24",height:"24",viewBox:"0 0 18 18"},r.a.createElement("polygon",{fillRule:"nonzero",fill:"currentColor",points:"15 10 10 10 10 15 8 15 8 10 3 10 3 8 8 8 8 3 10 3 10 8 15 8"})))),r.a.createElement("div",{id:"channelsGroupes","aria-label":"Salons de groupes"},r.a.createElement(L,{isShowing:this.state.isShowingNewGroupe,hide:this.toggleNewGroupe}),r.a.createElement(_,null))),r.a.createElement("div",{className:"sidebar-footer"},r.a.createElement("div",{className:"sidebar-footer-panels","aria-label":"Zone utilisateur"},r.a.createElement("div",{className:"sidebar-footer-panels-avatar"},r.a.createElement("svg",{width:"40",height:"32",viewBox:"0 0 40 32","aria-hidden":"true"},r.a.createElement("foreignObject",{x:"0",y:"0",width:"32",height:"32"},r.a.createElement("img",{className:"avatar",src:null==e?null:"https://collaps.xyz/collapsapi/api/file_avatar/id/".concat(e.id),"aria-hidden":"true",alt:""}),"//http://localhost:3000"),r.a.createElement("rect",{className:null==e?null:"online"===e.activity?"online":"offline",fill:"currentColor",width:"10",height:"10",x:"22",y:"22",rx:"15",ry:"15"}))),r.a.createElement("div",{className:"sidebar-footer-panels-info",onClick:this.copyId},r.a.createElement("div",{className:"username"},r.a.createElement("div",{className:"overflow"},null==e?null:e.pseudo)),r.a.createElement("div",{className:"tag"},r.a.createElement("div",{className:"overflow"},"#1012"))),r.a.createElement("div",{className:"sidebar-footer-panels-control"},r.a.createElement("button",{className:"btn-icon-small",type:"button",alt:"Bouton param\xe8tre",onClick:this.toggleSetting},r.a.createElement("svg",{viewBox:"0 0 24 24","aria-hidden":"false",width:"17",height:"17",x:"0",y:"0"},r.a.createElement("path",{fill:"currentColor",d:"m22.683 9.394-1.88-.239c-.155-.477-.346-.937-.569-1.374l1.161-1.495c.47-.605.415-1.459-.122-1.979l-1.575-1.575c-.525-.542-1.379-.596-1.985-.127l-1.493 1.161c-.437-.223-.897-.414-1.375-.569l-.239-1.877c-.09-.753-.729-1.32-1.486-1.32h-2.24c-.757 0-1.396.567-1.486 1.317l-.239 1.88c-.478.155-.938.345-1.375.569l-1.494-1.161c-.604-.469-1.458-.415-1.979.122l-1.575 1.574c-.542.526-.597 1.38-.127 1.986l1.161 1.494c-.224.437-.414.897-.569 1.374l-1.877.239c-.753.09-1.32.729-1.32 1.486v2.24c0 .757.567 1.396 1.317 1.486l1.88.239c.155.477.346.937.569 1.374l-1.161 1.495c-.47.605-.415 1.459.122 1.979l1.575 1.575c.526.541 1.379.595 1.985.126l1.494-1.161c.437.224.897.415 1.374.569l.239 1.876c.09.755.729 1.322 1.486 1.322h2.24c.757 0 1.396-.567 1.486-1.317l.239-1.88c.477-.155.937-.346 1.374-.569l1.495 1.161c.605.47 1.459.415 1.979-.122l1.575-1.575c.542-.526.597-1.379.127-1.985l-1.161-1.494c.224-.437.415-.897.569-1.374l1.876-.239c.753-.09 1.32-.729 1.32-1.486v-2.24c.001-.757-.566-1.396-1.316-1.486zm-10.683 7.606c-2.757 0-5-2.243-5-5s2.243-5 5-5 5 2.243 5 5-2.243 5-5 5z"}))),r.a.createElement(q,{isShowing:this.state.isShowingSetting,hide:this.toggleSetting,client:e})))))}}]),a}(n.Component);R.contextType=B;var J=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"welcome"},r.a.createElement("div",{className:"welcome-title"},"Bienvenue sur FInt.Tchat"),r.a.createElement("div",{className:"welcome-content"},"Pour ajouter un contact il faut cliquer sur le petit + a cot\xe9 de contacts, puis entrer son id et cliquez sur ajouter"))}}]),a}(n.Component);function Z(){var e,t=O(),a=t.client,s=t.updateUser,l=M(),i=l.setChannels,o=l.selectedChannel,d=l.setSelectedChannel,u=l.messagesChannels,m=l.sendMessage,p=Object(n.useState)(""),v=Object(c.a)(p,2),h=v[0],g=v[1];return Object(n.useEffect)((function(){try{var e=document.getElementById("msgTextarea");window.screen.height>=1e3?e.style.maxHeight="330px":window.screen.height>=900?e.style.maxHeight="286px":window.screen.height>=800?e.style.maxHeight="242px":window.screen.height>=700?e.style.maxHeight="198px":window.screen.height>=600?e.style.maxHeight="154px":window.screen.height>=500&&(e.style.maxHeight="110px"),e.addEventListener("input",(function(e){this.style.height="22px",this.style.height=this.scrollHeight-22+"px"}))}catch(t){console.error(t)}}),[]),Object(n.useEffect)((function(){document.getElementById("messageBodyScroll").scrollIntoView({behavior:"smooth"})}),[o]),Object(n.useEffect)((function(){var e,t=document.getElementById("messageBodyScroll");(e=t).scrollTop=e.scrollHeight}),[u]),r.a.createElement("div",{className:"message"},r.a.createElement("div",{className:"message-header"},r.a.createElement("div",{className:"message-header-user"},r.a.createElement("div",{className:"message-header-user-avatar"},r.a.createElement("img",{className:"avatar",src:"https://collaps.xyz/collapsapi/api/file_avatar/id/".concat(o.recipients[0].id),alt:"user profil"})),r.a.createElement("div",{className:"message-header-user-info"},r.a.createElement("div",{className:"username"},o.recipients[0].pseudo),r.a.createElement("div",{className:"statut online"},r.a.createElement("svg",{viewBox:"0 0 512 512","aria-hidden":"false",width:"10",height:"15",x:"0",y:"0"},r.a.createElement("path",{fill:"currentColor",d:"M256,0C115.39,0,0,115.39,0,256s115.39,256,256,256s256-115.39,256-256S396.61,0,256,0z"}))))),r.a.createElement("div",{className:"message-header-toolbar"},r.a.createElement("button",{className:"btn-icon-small-red",type:"button",onClick:function(){for(var e=a,t=0;t<e.channels.length;t++)e.channels[t].id===o.id&&(e.channels.splice(t,1),f.updateUserById(e.id,{data:{channels:e.channels}}).then((function(e){})));f.getUserById(o.recipients[0].id).then((function(e){for(var t=e.data.data,a=0;a<t.channels.length;a++)t.channels[a].id===o.id&&(t.channels.splice(a,1),s(t.id,{data:{channels:t.channels}}))}),(function(e){console.log(e)})),i((function(e){return[].concat(Object(k.a)(e.slice(0,o.key)),Object(k.a)(e.slice(o.key+1)))})),d(null),f.deleteChannelById(o.id)}},r.a.createElement("svg",{viewBox:"0 0 512 512","aria-hidden":"false",width:"20",height:"20",x:"0",y:"0"},r.a.createElement("polygon",{fill:"currentColor",points:"512,338.954 483.732,310.686 411.772,382.646 339.812,310.686 311.543,338.954 383.503,410.914 311.543,482.874  339.812,511.142 411.772,439.182 483.732,511.142 512,482.874 440.04,410.914 \t\t"}),r.a.createElement("path",{fill:"currentColor",d:"M255.858,0.142c-81.562,0-147.918,66.356-147.918,147.918c0,50.52,25.465,95.198,64.226,121.894 c-36.19,12.488-69.36,33.118-97.227,60.984C26.614,379.265,0,443.516,0,511.858h39.978c0-119.037,96.843-215.88,215.88-215.88 c81.562,0,147.918-66.355,147.918-147.918C403.776,66.498,337.42,0.142,255.858,0.142z M255.858,256 c-59.518,0-107.94-48.421-107.94-107.94S196.34,40.12,255.858,40.12c59.518,0,107.94,48.421,107.94,107.94 S315.376,256,255.858,256z"}))))),r.a.createElement("div",{className:"message-body scroller",id:"messageBodyScroll"},o.messages.map((function(t,n){var s=new Date(t.date);s="".concat(s.getDate(),"/").concat(s.getMonth()+1,"/").concat(s.getFullYear()," ").concat(s.getHours(),":").concat(s.getMinutes());var l=null===a?null:t.sender===a.id?a.pseudo:o.recipients.find((function(e){return e.id===t.sender})).pseudo,c=e;return(e=t.sender)!==c?r.a.createElement("div",{className:"message-body-message parents",key:n},r.a.createElement("div",{className:"message-body-message-avatar"},r.a.createElement("img",{className:"avatar",src:"https://collaps.xyz/collapsapi/api/file_avatar/id/".concat(t.sender),alt:"user profil"})),r.a.createElement("h2",{className:"message-body-message-header"},r.a.createElement("span",{className:"pseudo"},l),r.a.createElement("span",{className:"timestamp"},s)),r.a.createElement("div",{className:"message-body-message-text"},t.text)):r.a.createElement("div",{className:"message-body-message children",key:n},r.a.createElement("div",{className:"message-body-message-text"},t.text))})),0===u.length?null:u.find((function(e){return e.id===o.id})).messages.map((function(t,a){var n=new Date(t.date);n="".concat(n.getDate(),"/").concat(n.getMonth()+1,"/").concat(n.getFullYear()," ").concat(n.getHours(),":").concat(n.getMinutes());var s=e;return(e=t.sender.id)!==s?r.a.createElement("div",{className:"message-body-message parents",key:a},r.a.createElement("div",{className:"message-body-message-avatar"},r.a.createElement("img",{className:"avatar",src:"https://collaps.xyz/collapsapi/api/file_avatar/id/".concat(t.sender.id),alt:"user profil"})),r.a.createElement("h2",{className:"message-body-message-header"},r.a.createElement("span",{className:"pseudo"},t.sender.pseudo),r.a.createElement("span",{className:"timestamp"},n)),r.a.createElement("div",{className:"message-body-message-text"},t.text)):r.a.createElement("div",{className:"message-body-message children",key:a},r.a.createElement("div",{className:"message-body-message-text"},t.text))})),r.a.createElement("div",{className:"message-body-spacer",id:"spacer"})),r.a.createElement("div",{className:"message-footer"},r.a.createElement("form",{className:"message-footer-toolbar",onSubmit:function(e){e.preventDefault(),m(o,h,a),g("")}},r.a.createElement("div",{className:"message-footer-toolbar-uploadBtn"},r.a.createElement("svg",{className:"icon",width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{fill:"currentColor",d:"M12 2.00098C6.486 2.00098 2 6.48698 2 12.001C2 17.515 6.486 22.001 12 22.001C17.514 22.001 22 17.515 22 12.001C22 6.48698 17.514 2.00098 12 2.00098ZM17 13.001H13V17.001H11V13.001H7V11.001H11V7.00098H13V11.001H17V13.001Z"})),r.a.createElement("input",{className:"input",type:"file",multiple:!0})),r.a.createElement("textarea",{id:"msgTextarea",className:"message-footer-toolbar-textarea scroller",placeholder:"Envoyer un message \xe0 "+o.recipients[0].pseudo,spellCheck:"true",autoFocus:!0,autoComplete:"off",value:h,onChange:function(e){return g(e.target.value)},required:!0}),r.a.createElement("button",{className:"message-footer-toolbar-sendBtn",type:"submit"},r.a.createElement("svg",{viewBox:"0 0 512 512","aria-hidden":"false",width:"20",height:"20"},r.a.createElement("path",{fill:"currentColor",d:"M481.508,210.336L68.414,38.926c-17.403-7.222-37.064-4.045-51.309,8.287C2.86,59.547-3.098,78.551,1.558,96.808 L38.327,241h180.026c8.284,0,15.001,6.716,15.001,15.001c0,8.284-6.716,15.001-15.001,15.001H38.327L1.558,415.193 c-4.656,18.258,1.301,37.262,15.547,49.595c14.274,12.357,33.937,15.495,51.31,8.287l413.094-171.409 C500.317,293.862,512,276.364,512,256.001C512,235.638,500.317,218.139,481.508,210.336z"}))))))}function Y(e){e.id;var t=M().selectedChannel;return r.a.createElement(r.a.Fragment,null,r.a.createElement(R,null),r.a.createElement("div",{className:"container"},null!==t?t&&r.a.createElement(Z,null):r.a.createElement(J,null)))}var K=function(){var e=function(e,t){var a="FInt-"+e,r=Object(n.useState)((function(){var e=localStorage.getItem(a);return null!=e?JSON.parse(e):"function"===typeof t?t():t})),s=Object(c.a)(r,2),l=s[0],i=s[1];return Object(n.useEffect)((function(){null!=l&&localStorage.setItem(a,JSON.stringify(l))}),[a,l]),[l,i]}("id"),t=Object(c.a)(e,2),a=t[0],s=t[1],l=r.a.createElement(F,{id:a},r.a.createElement(I,{id:a},r.a.createElement(z,{id:a},r.a.createElement(Y,{id:a}))));return void 0===a?r.a.createElement(S,{onIdSubmit:s}):l};l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(K,null)),document.getElementById("main"))},40:function(e,t){e.exports={validityPseudo:function(e){var t=e.length;switch(!0){case 0===t:return{warning:"",valid:!1};case t<3:return{warning:"Trop court",valid:!1};case t>32:return{warning:"Trop long",valid:!1};default:return{warning:"",valid:!0}}},validityPassword:function(e){var t=e.length;switch(!0){case 0===t:return{warning:"",valid:!1};case t<6:return{warning:"Trop court",valid:!1};case t>32:return{warning:"Trop long",valid:!1};default:return{warning:"",valid:!0}}},validityPasswordConfirm:function(e,t){switch(!0){case 0===e.length:return{warning:"",valid:!1};case e!==t:return{warning:"Incorrect",valid:!1};default:return{warning:"",valid:!0}}},validityPasswordConfirmForPassword:function(e,t){switch(!0){case 0===e.length:return{warning:"",valid:!1};case e!==t:return{warning:"Le mot de passe ne corrrespond pas",valid:!1};default:return{warning:"",valid:!0}}}}},57:function(e,t,a){e.exports=a(111)}},[[57,1,2]]]);
//# sourceMappingURL=main.44b7eb2f.chunk.js.map