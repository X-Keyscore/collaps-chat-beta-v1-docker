{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\anton\\\\Desktop\\\\FInt.Tchat\\\\dev\\\\V10\\\\client\\\\src\\\\components\\\\sidebar\\\\windows\\\\setting.js\";\nimport React, { Component } from 'react';\nimport ReactDOM from \"react-dom\";\nimport api from \"../../../api\";\n\nconst {\n  validityPseudo\n} = require(\"../../../functions/validity.js\");\n\nexport default class Setting extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleChangeInputAvatar = async event => {\n      // .jpg,.jpeg,.png,.gif\n      const files = event.target.files;\n      const avatar = files[0];\n      const type = /image.*/;\n      if (!avatar.type.match(type)) return; //if (avatar.size > (100*1024)) return\n\n      this.setState({\n        selectedFiles: event.target.files\n      });\n    };\n\n    this.handleChangeInputPseudo = async event => {\n      const pseudo = event.target.value;\n      const rep = validityPseudo(pseudo);\n      this.setState({\n        pseudo: {\n          value: pseudo,\n          warning: rep.warning,\n          valid: rep.valid\n        }\n      });\n    };\n\n    this.state = {\n      selectedFiles: [],\n      pseudo: {\n        value: 'x',\n        warning: '',\n        valid: false\n      }\n    }; // Cette liaison est nécéssaire afin de permettre\n    // l'utilisation de `this` dans la fonction de rappel.\n\n    this.handleUpdateUser = this.handleUpdateUser.bind(this);\n    this.resetAndHide = this.resetAndHide.bind(this);\n  } // onChange management \n  // Avatar\n\n\n  // Submit management\n  handleUpdateUser() {\n    api.getFileById(this.props.client.id).then(res => {}); // UploadAvatar\n    // https://github.com/MaksymRudnyi/turorials/\n    // FormData permet de stocker plusieur fichiers à la fois\n\n    const file = new FormData(); // Ajoute le fichier au formData avec append\n\n    file.append('file', this.state.selectedFiles[0], `${this.props.client.id}-${this.state.selectedFiles[0].name}`); // Envoie de la requête\n\n    api.insertFile_avatar(file).then(res => {\n      console.log('Upload Success');\n    }).catch(err => {\n      console.log('Upload Error');\n    }); // UploadPseudo\n\n    const {\n      pseudo\n    } = this.state;\n\n    if (pseudo.valid === true) {\n      // Requête a l'api pour rechercher le pseudo\n      api.getUserByPseudo(pseudo.value).then(res => {\n        // Je vérifie si le pseudo est déjà utilisé\n        // sinon ont mes à jour l'utilisateur\n        if (res.data.data !== null) {\n          this.setState({\n            pseudo: {\n              value: pseudo.value,\n              warning: 'ce pseudo est déjà utilisé'\n            }\n          });\n        } else {\n          this.resetAndHide();\n          api.updateUserById(this.props.client.id, {\n            data: {\n              pseudo: pseudo.value\n            }\n          }).then(res => {\n            console.log(\"Mise à jour de l'utilisateur\");\n          }, error => {\n            console.log(\"Problème d'enregistrement dans la base de données\");\n            console.log(error);\n          });\n        }\n      });\n    } else {\n      if (pseudo.value.length === 0) {\n        this.setState({\n          pseudo: {\n            value: pseudo.value,\n            warning: 'Ne peut être vide'\n          }\n        });\n      } else {\n        this.resetAndHide();\n      }\n    }\n  } // Nettoyage du 'State' et fermeture\n\n\n  resetAndHide() {\n    this.setState({\n      selectedFiles: [],\n      pseudo: {\n        value: 'x',\n        warning: '',\n        valid: false\n      }\n    });\n    this.props.hide();\n  }\n\n  render() {\n    const {\n      pseudo,\n      selectedFiles\n    } = this.state; // Récupération des données du client dans l’état local\n\n    const client = this.props.client;\n    return this.props.isShowing ? ReactDOM.createPortal( /*#__PURE__*/React.createElement(\"div\", {\n      className: \"window\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"window-backdrop\",\n      onClick: this.props.hide,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"form\", {\n      className: \"window-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"windowToolHeader\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"windowToolHeader-title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 17\n      }\n    }, \"Param\\xE8tres\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"windowToolHeader-subtitle\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 17\n      }\n    }, \"Clic sur ton pseudo pour le modifier\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"clientSetting-body scroller\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"clientSetting-body-divider\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 19\n      }\n    }, \"Compte\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"bar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 54\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"clientSetting-body-account\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"clientSetting-body-account-avatar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      className: \"avatar\",\n      src: selectedFiles.length == 0 ? \"https://cdn.discordapp.com/avatars/456863924210630657/1d92f56700533a272820d955d2dc4f29.png?size=128\" : URL.createObjectURL(selectedFiles[0]),\n      alt: \"user account\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      className: \"avatarUploaderInput\",\n      type: \"file\",\n      accept: \".jpg,.jpeg,.png,.gif\",\n      onChange: this.handleChangeInputAvatar,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"avatarUploaderIcon\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"clientSetting-body-account-info\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"pseudo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 23\n      }\n    }, \"Pseudo \", pseudo.warning ? /*#__PURE__*/React.createElement(\"span\", {\n      className: \"title-warning\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 71\n      }\n    }, \"- \", pseudo.warning) : null), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      className: \"input\",\n      type: \"text\",\n      maxLength: \"32\",\n      required: true,\n      value: pseudo.value === \"x\" ? client === null ? null : client.pseudo : pseudo.value,\n      onChange: this.handleChangeInputPseudo,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 25\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"tag\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 23\n      }\n    }, \"Tag\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 23\n      }\n    }, \"#1012\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"id\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 23\n      }\n    }, \"Id\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 23\n      }\n    }, client.id)))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"clientSetting-body-divider\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 19\n      }\n    }, \"Informations\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"bar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 60\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"clientSetting-body-info\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"clientSetting-body-info-compatibility\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 21\n      }\n    }, \"Compatible\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"navigator\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 23\n      }\n    }, \"Mozilla Firefox\"), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 23\n      }\n    }, \"Google Chrome\"), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 23\n      }\n    }, \"Apple Safari\"), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 23\n      }\n    }, \"Microsoft Edge\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"clientSetting-body-info-support\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 21\n      }\n    }, \"Support\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"navigator\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 23\n      }\n    }, \"Windows\"), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 23\n      }\n    }, \"MacOS\"), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 23\n      }\n    }, \"Android\"), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 23\n      }\n    }, \"iOS\"))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"windowToolFooter\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn-icon-default-red\",\n      type: \"button\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"svg\", {\n      viewBox: \"0 0 384 384\",\n      \"aria-hidden\": \"false\",\n      width: \"21\",\n      height: \"21\",\n      x: \"0\",\n      y: \"0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"path\", {\n      fill: \"currentColor\",\n      d: \"M341.333,0H42.667C19.093,0,0,19.093,0,42.667V128h42.667V42.667h298.667v298.667H42.667V256H0v85.333\\r C0,364.907,19.093,384,42.667,384h298.667C364.907,384,384,364.907,384,341.333V42.667C384,19.093,364.907,0,341.333,0z\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"polygon\", {\n      fill: \"currentColor\",\n      points: \"151.147,268.48 181.333,298.667 288,192 181.333,85.333 151.147,115.52 206.293,170.667 0,170.667 0,213.333 \\r 206.293,213.333\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 21\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"windowToolFooter-btn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn-text-default\",\n      type: \"button\",\n      onClick: this.handleUpdateUser,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 21\n      }\n    }, \"Termin\\xE9\")), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn-text-simple\",\n      type: \"button\",\n      onClick: this.resetAndHide,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 21\n      }\n    }, \"Annuler\")))))), document.body) : null;\n  }\n\n}\n/*\r\n{selectedFiles.length == 0 ? \"rien\" : <img style={{maxWidth: '200px'}} src={URL.createObjectURL(selectedFiles[0])} alt={selectedFiles[0].originalname}/>}\r\n{selectedFiles.length == 0 ? \"rien\" : selectedFiles.map((file) => <img style={{maxWidth: '200px'}} src={`//localhost:8000/${file.filename}`} alt={file.originalname}/>)}\r\n\r\n*/","map":{"version":3,"sources":["C:/Users/anton/Desktop/FInt.Tchat/dev/V10/client/src/components/sidebar/windows/setting.js"],"names":["React","Component","ReactDOM","api","validityPseudo","require","Setting","constructor","props","handleChangeInputAvatar","event","files","target","avatar","type","match","setState","selectedFiles","handleChangeInputPseudo","pseudo","value","rep","warning","valid","state","handleUpdateUser","bind","resetAndHide","getFileById","client","id","then","res","file","FormData","append","name","insertFile_avatar","console","log","catch","err","getUserByPseudo","data","updateUserById","error","length","hide","render","isShowing","createPortal","URL","createObjectURL","document","body"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport ReactDOM from \"react-dom\";\r\n\r\nimport api from \"../../../api\"\r\nconst { validityPseudo } = require(\"../../../functions/validity.js\");\r\n\r\nexport default class Setting extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      selectedFiles: [],\r\n      pseudo: {\r\n        value: 'x',\r\n        warning: '',\r\n        valid: false\r\n      }\r\n    }\r\n\r\n    // Cette liaison est nécéssaire afin de permettre\r\n    // l'utilisation de `this` dans la fonction de rappel.\r\n    this.handleUpdateUser = this.handleUpdateUser.bind(this);\r\n    this.resetAndHide = this.resetAndHide.bind(this);\r\n  }\r\n\r\n  // onChange management \r\n\r\n  // Avatar\r\n  handleChangeInputAvatar = async event => {\r\n\r\n    // .jpg,.jpeg,.png,.gif\r\n\r\n    const files = event.target.files\r\n    const avatar = files[0]\r\n    const type = /image.*/\r\n  \r\n    if (!avatar.type.match(type)) return\r\n  \r\n    //if (avatar.size > (100*1024)) return\r\n\r\n    this.setState({\r\n      selectedFiles: event.target.files,\r\n    });\r\n  }\r\n\r\n  // Pseudo\r\n  handleChangeInputPseudo = async event => {\r\n    const pseudo = event.target.value\r\n    const rep = validityPseudo(pseudo);\r\n    this.setState({\r\n      pseudo: {\r\n        value: pseudo,\r\n        warning: rep.warning,\r\n        valid: rep.valid\r\n      }\r\n    })\r\n  }\r\n\r\n  // Submit management\r\n\r\n  handleUpdateUser() {\r\n\r\n    api.getFileById(this.props.client.id).then(res => {\r\n      \r\n    })\r\n\r\n    // UploadAvatar\r\n    // https://github.com/MaksymRudnyi/turorials/\r\n\r\n    // FormData permet de stocker plusieur fichiers à la fois\r\n    const file = new FormData();\r\n\r\n    // Ajoute le fichier au formData avec append\r\n    file.append('file', this.state.selectedFiles[0], `${this.props.client.id}-${this.state.selectedFiles[0].name}`);\r\n\r\n    // Envoie de la requête\r\n    api.insertFile_avatar(file)\r\n      .then((res) => {\r\n        console.log('Upload Success')\r\n      })\r\n      .catch((err) => {\r\n        console.log('Upload Error')\r\n      })\r\n\r\n    // UploadPseudo\r\n    const { pseudo } = this.state\r\n    if (pseudo.valid === true) {\r\n\r\n      // Requête a l'api pour rechercher le pseudo\r\n      api.getUserByPseudo(pseudo.value).then(res => {\r\n\r\n        // Je vérifie si le pseudo est déjà utilisé\r\n        // sinon ont mes à jour l'utilisateur\r\n        if (res.data.data !== null) {\r\n          this.setState({\r\n            pseudo: {\r\n              value: pseudo.value,\r\n              warning: 'ce pseudo est déjà utilisé'\r\n            }\r\n          })\r\n        } else {\r\n\r\n          this.resetAndHide()\r\n\r\n          api.updateUserById(this.props.client.id, { data: { pseudo: pseudo.value } }).then(\r\n            (res) => {\r\n              console.log(\"Mise à jour de l'utilisateur\")\r\n            },\r\n            (error) => {\r\n              console.log(\"Problème d'enregistrement dans la base de données\")\r\n              console.log(error)\r\n            })\r\n        }\r\n      })\r\n    } else {\r\n      if (pseudo.value.length === 0) {\r\n        this.setState({\r\n          pseudo: {\r\n            value: pseudo.value,\r\n            warning: 'Ne peut être vide'\r\n          }\r\n        })\r\n      } else {\r\n        this.resetAndHide()\r\n      }\r\n    }\r\n  }\r\n\r\n  // Nettoyage du 'State' et fermeture\r\n  resetAndHide() {\r\n    this.setState({\r\n      selectedFiles: [],\r\n      pseudo: {\r\n        value: 'x',\r\n        warning: '',\r\n        valid: false\r\n      }\r\n    })\r\n\r\n    this.props.hide()\r\n  }\r\n\r\n  render() {\r\n    const { pseudo, selectedFiles } = this.state\r\n    // Récupération des données du client dans l’état local\r\n    const client = this.props.client\r\n\r\n    return (\r\n      this.props.isShowing\r\n        ? ReactDOM.createPortal(\r\n          <div className=\"window\">\r\n            <div className=\"window-backdrop\" onClick={this.props.hide}></div>\r\n            <form className=\"window-container\">\r\n              <div className=\"windowToolHeader\">\r\n                <div className=\"windowToolHeader-title\">\r\n                  Paramètres\r\n                </div>\r\n                <div className=\"windowToolHeader-subtitle\">\r\n                  Clic sur ton pseudo pour le modifier\r\n                </div>\r\n              </div>\r\n              <div className=\"clientSetting-body scroller\">\r\n                <div className=\"clientSetting-body-divider\">\r\n                  <div className=\"title\">Compte</div><div className=\"bar\"></div>\r\n                </div>\r\n\r\n                <div className=\"clientSetting-body-account\">\r\n                  <div className=\"clientSetting-body-account-avatar\">\r\n                    <img className=\"avatar\" src={selectedFiles.length == 0 ? \"https://cdn.discordapp.com/avatars/456863924210630657/1d92f56700533a272820d955d2dc4f29.png?size=128\" : URL.createObjectURL(selectedFiles[0])}\r\n                      alt=\"user account\" />\r\n                    <input className=\"avatarUploaderInput\" type=\"file\" accept=\".jpg,.jpeg,.png,.gif\" onChange={this.handleChangeInputAvatar} />\r\n                    <div className=\"avatarUploaderIcon\"></div>\r\n                  </div>\r\n                  <div className=\"clientSetting-body-account-info\">\r\n                    <div className=\"pseudo\">\r\n                      <div className=\"title\">Pseudo {pseudo.warning ? <span className=\"title-warning\">- {pseudo.warning}</span> : null}</div>\r\n                      <div className=\"content\">\r\n                        <input\r\n                          className=\"input\"\r\n                          type=\"text\"\r\n                          maxLength=\"32\"\r\n                          required\r\n                          value={pseudo.value === \"x\" ? client === null ? null : client.pseudo : pseudo.value}\r\n                          onChange={this.handleChangeInputPseudo}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"tag\">\r\n                      <div className=\"title\">Tag</div>\r\n                      <div className=\"content\">#1012</div>\r\n                    </div>\r\n                    <div className=\"id\">\r\n                      <div className=\"title\">Id</div>\r\n                      <div className=\"content\">{client.id}</div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"clientSetting-body-divider\">\r\n                  <div className=\"title\">Informations</div><div className=\"bar\"></div>\r\n                </div>\r\n\r\n                <div className=\"clientSetting-body-info\">\r\n                  <div className=\"clientSetting-body-info-compatibility\">\r\n                    <div className=\"title\">Compatible</div>\r\n                    <div className=\"navigator\">\r\n                      <li>Mozilla Firefox</li>\r\n                      <li>Google Chrome</li>\r\n                      <li>Apple Safari</li>\r\n                      <li>Microsoft Edge</li>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"clientSetting-body-info-support\">\r\n                    <div className=\"title\">Support</div>\r\n                    <div className=\"navigator\">\r\n                      <li>Windows</li>\r\n                      <li>MacOS</li>\r\n                      <li>Android</li>\r\n                      <li>iOS</li>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n              </div>\r\n              <div className=\"windowToolFooter\">\r\n                <button className=\"btn-icon-default-red\" type=\"button\">\r\n                  <svg viewBox=\"0 0 384 384\" aria-hidden=\"false\" width=\"21\" height=\"21\" x=\"0\" y=\"0\">\r\n                    <path fill=\"currentColor\" d=\"M341.333,0H42.667C19.093,0,0,19.093,0,42.667V128h42.667V42.667h298.667v298.667H42.667V256H0v85.333\r\n                      C0,364.907,19.093,384,42.667,384h298.667C364.907,384,384,364.907,384,341.333V42.667C384,19.093,364.907,0,341.333,0z\"/>\r\n                    <polygon fill=\"currentColor\" points=\"151.147,268.48 181.333,298.667 288,192 181.333,85.333 151.147,115.52 206.293,170.667 0,170.667 0,213.333 \r\n                      206.293,213.333\" />\r\n                  </svg>\r\n                </button>\r\n                <div className=\"windowToolFooter-btn\">\r\n                  <button className=\"btn-text-default\" type=\"button\" onClick={this.handleUpdateUser}>\r\n                    <div className=\"content\">Terminé</div>\r\n                  </button>\r\n                  <button className=\"btn-text-simple\" type=\"button\" onClick={this.resetAndHide}>\r\n                    <div className=\"content\">Annuler</div>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </form>\r\n          </div>,\r\n          document.body\r\n        ) : null\r\n    )\r\n  }\r\n}\r\n\r\n/*\r\n{selectedFiles.length == 0 ? \"rien\" : <img style={{maxWidth: '200px'}} src={URL.createObjectURL(selectedFiles[0])} alt={selectedFiles[0].originalname}/>}\r\n{selectedFiles.length == 0 ? \"rien\" : selectedFiles.map((file) => <img style={{maxWidth: '200px'}} src={`//localhost:8000/${file.filename}`} alt={file.originalname}/>)}\r\n\r\n*/"]},"metadata":{},"sourceType":"module"}